<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading Movie...</title>
    <style>
        :root { --theme-color: #e74c3c; --dark-bg: #121212; --light-bg: #1f1f1f; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; background-color: var(--dark-bg); color: #fff; margin: 0; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        a { color: inherit; text-decoration: none; }
        header { background-color: var(--dark-bg); padding: 10px; border-bottom: 1px solid #2a2a2a; }
        .nav-bar { display: flex; justify-content: center; align-items: center; max-width: 1200px; margin: 0 auto; height: 50px; position: relative; }
        header img.logo { max-width: 120px; }
        .back-btn { position: absolute; left: 0; top: 50%; transform: translateY(-50%); font-size: 24px; padding: 10px; }
        .movie-info-container { display: flex; flex-direction: column; gap: 20px; margin-top: 30px; }
        @media (min-width: 768px) { .movie-info-container { flex-direction: row; gap: 30px; } }
        .movie-poster-large { width: 100%; max-width: 250px; height: auto; object-fit: cover; border-radius: 8px; align-self: center; }
        .movie-text-details { flex-grow: 1; }
        #movie-title { font-size: 32px; margin: 0 0 15px 0; }
        #movie-description { font-size: 16px; color: #ccc; line-height: 1.6; }
        .section-title { font-size: 22px; margin-top: 30px; border-bottom: 2px solid var(--theme-color); padding-bottom: 10px; }
        .cast-list { display: flex; flex-wrap: wrap; gap: 10px; padding: 0; margin-top: 15px; }
        .cast-member { background-color: var(--light-bg); padding: 8px 15px; border-radius: 20px; font-size: 14px; }
        .download-links { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 20px; }
        .download-btn { background-color: var(--theme-color); color: white; padding: 12px 25px; border-radius: 5px; font-size: 16px; font-weight: bold; display: inline-flex; align-items: center; gap: 10px; }
        .download-btn svg { width: 20px; height: 20px; fill: white; }
        .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 12px; margin-top: 20px; }
        .movie-card { position: relative; }
        .movie-card img { width: 100%; height: auto; display: block; border-radius: 6px; aspect-ratio: 2/3; object-fit: cover; }
        .movie-info h3 { font-size: 14px; margin: 8px 0 0 0; }
        .loading-error { text-align: center; font-size: 20px; margin-top: 50px; }
        .movie-card-overlay { position: absolute; top: 5px; left: 5px; background-color: var(--theme-color); color: white; padding: 3px 8px; font-size: 10px; font-weight: bold; border-radius: 4px; z-index: 2; }
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); display: flex; justify-content: center; align-items: center; }
        .modal-content { background-color: var(--light-bg); padding: 25px; border-top: 4px solid var(--theme-color); border-radius: 8px; width: 80%; max-width: 400px; text-align: center; animation-name: zoomIn; animation-duration: 0.3s; position: relative; }
        .close-btn { color: #aaa; position: absolute; top: 10px; right: 20px; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close-btn:hover, .close-btn:focus { color: white; }
        @keyframes zoomIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        #modal-title { font-size: 22px; margin-top: 0; color: var(--theme-color); }
        #modal-quality-message { font-size: 18px; margin-bottom: 10px; }
        #modal-generic-message { font-size: 14px; color: var(--text-secondary); }
    </style>
</head>
<body>
    <header>
        <nav class="nav-bar">
            <a href="index.html" class="back-btn">&#8592;</a>
            <a href="index.html"><img src="https://raw.githubusercontent.com/Armanedits/Movies/refs/heads/main/Picsart_25-10-11_05-15-44-256.jpg" alt="Logo" class="logo"></a>
        </nav>
    </header>
    <main class="container">
        <div id="loader" class="loading-error">Loading...</div>
        <div id="movie-details-view" style="display:none;">
            <div class="movie-info-container">
                <img src="" alt="Movie Poster" id="main-poster" class="movie-poster-large">
                <div class="movie-text-details">
                    <h1 id="movie-title"></h1>
                    <p id="movie-description"></p>
                    <div id="cast-section" style="display: none;"><h2 class="section-title">Cast</h2><div id="cast-list" class="cast-list"></div></div>
                    <h2 class="section-title">Download Links</h2>
                    <div id="download-links" class="download-links"></div>
                </div>
            </div>
            <div id="related-movies-section" style="display: none;"><h2 class="section-title">You might also like</h2><div id="related-movies-grid" class="movie-grid"></div></div>
        </div>
    </main>
    <div id="link-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2 id="modal-title">Ultimate Movie Site</h2>
            <p id="modal-quality-message"></p>
            <p id="modal-generic-message">Download link will be updated soon!</p>
        </div>
    </div>
<script>
    const modal = document.getElementById('link-modal');
    const closeBtn = document.querySelector('.close-btn');
    
    // === POPUP MESSAGE FIX IS HERE ===
    function showModal(movieTitle, quality) {
        let message = `"${movieTitle}" (${quality}) download link is not available yet.`;
        document.getElementById('modal-quality-message').textContent = message;
        modal.style.display = 'flex';
    }

    function closeModal() { modal.style.display = 'none'; }
    closeBtn.onclick = closeModal;
    window.onclick = function(event) { if (event.target == modal) { closeModal(); } }

    document.addEventListener('DOMContentLoaded', () => {
        const MOVIES_JSON_URL = "movies.json";
        const loader = document.getElementById('loader');
        const movieDetailsView = document.getElementById('movie-details-view');

        async function loadMovie() {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const movieId = urlParams.get('id');
                if (!movieId) throw new Error('Movie ID not found in URL.');
                const response = await fetch(MOVIES_JSON_URL);
                if (!response.ok) throw new Error(`Could not load movies.json.`);
                const allMovies = await response.json();
                const currentMovie = allMovies.find(m => m.id === movieId);
                if (!currentMovie) throw new Error('Movie with this ID not found.');
                displayMovieDetails(currentMovie, allMovies);
                loader.style.display = 'none';
                movieDetailsView.style.display = 'block';
            } catch (error) { loader.textContent = `Error: ${error.message}`; }
        }

        function displayMovieDetails(movie, allMovies) {
            document.title = movie.title;
            document.getElementById('main-poster').src = movie.poster;
            document.getElementById('movie-title').textContent = movie.title;
            const descriptionEl = document.getElementById('movie-description');
            if (movie.details) { descriptionEl.textContent = movie.details; } else { descriptionEl.style.display = 'none'; }
            const castSection = document.getElementById('cast-section');
            if (movie.cast && movie.cast.length > 0) {
                castSection.style.display = 'block';
                document.getElementById('cast-list').innerHTML = movie.cast.map(actor => `<span class="cast-member">${actor}</span>`).join('');
            }
            const downloadsContainer = document.getElementById('download-links');
            if (movie.downloadLinks && movie.downloadLinks.length > 0) {
                downloadsContainer.innerHTML = movie.downloadLinks.map(linkInfo => {
                    let buttonText = linkInfo.quality || 'Download';
                    if (linkInfo.size) buttonText += ` (${linkInfo.size})`;
                    if (linkInfo.link === '#') {
                        // Pass movie title and quality to the modal function
                        return `<a href="javascript:void(0);" onclick="showModal('${movie.title}', '${linkInfo.quality || 'This'}')" class="download-btn"><svg viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>${buttonText}</a>`;
                    } else {
                        return `<a href="${linkInfo.link}" class="download-btn" target="_blank"><svg viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>${buttonText}</a>`;
                    }
                }).join('');
            } else {
                downloadsContainer.innerHTML = '<p>No download links available.</p>';
            }
            const relatedSection = document.getElementById('related-movies-section');
            if (movie.suggestedIds && movie.suggestedIds.length > 0) {
                const relatedMovies = movie.suggestedIds.map(id => allMovies.find(m => m.id === id)).filter(Boolean);
                if (relatedMovies.length > 0) {
                    relatedSection.style.display = 'block';
                    document.getElementById('related-movies-grid').innerHTML = relatedMovies.map(relMovie => {
                        const overlayStyle = relMovie.overlay_text_color ? `style="background-color: ${relMovie.overlay_text_color};"` : '';
                        const overlayHTML = relMovie.overlay_text ? `<div class="movie-card-overlay" ${overlayStyle}>${relMovie.overlay_text}</div>` : '';
                        return `<a href="player.html?id=${relMovie.id}"><div class="movie-card">${overlayHTML}<img src="${relMovie.poster}" alt="${relMovie.title}"><div class="movie-info"><h3>${relMovie.title}</h3></div></div></a>`;
                    }).join('');
                }
            }
        }
        loadMovie();
    });
</script>
</body>
</html>
