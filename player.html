
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading Movie...</title>
    <!-- === CSS (Naya Details Page Style) === -->
    <style>
        :root { --theme-color: #e74c3c; --dark-bg: #121212; --light-bg: #1f1f1f; --card-text-bg: #0c0c0c; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; background-color: var(--dark-bg); color: #fff; margin: 0; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        a { color: inherit; text-decoration: none; }
        
        /* Header ka Style */
        header { text-align: center; padding: 20px 0; border-bottom: 1px solid #222; }
        header img.logo { max-width: 150px; }

        /* Movie Details Section ka Style */
        .movie-info-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-top: 30px;
        }
        @media (min-width: 768px) {
            .movie-info-container { flex-direction: row; }
        }

        .movie-poster-large {
            width: 100%;
            max-width: 250px;
            height: auto;
            object-fit: cover;
            border-radius: 8px;
            align-self: center;
        }

        .movie-text-details {
            flex-grow: 1;
        }

        #movie-title { font-size: 32px; margin: 0 0 15px 0; }
        #movie-description { font-size: 16px; color: #ccc; line-height: 1.6; }
        
        /* Cast aur Download Links ka Style */
        h2.section-title { font-size: 22px; margin-top: 30px; border-bottom: 2px solid var(--theme-color); padding-bottom: 10px; }
        .cast-list { display: flex; flex-wrap: wrap; gap: 10px; padding: 0; margin-top: 15px; }
        .cast-member { background-color: var(--light-bg); padding: 8px 15px; border-radius: 20px; font-size: 14px; }
        
        .download-links { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 20px; }
        .download-btn {
            background-color: var(--theme-color);
            color: white;
            padding: 12px 25px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: background-color 0.2s;
        }
        .download-btn:hover { background-color: #c0392b; }
        .download-btn svg { width: 20px; height: 20px; fill: white; }

        /* Related Movies ka Style (pehle jaisa) */
        .related-movies { margin-top: 50px; }
        #related-movies-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 20px; margin-top: 20px; }
        .movie-card { background-color: var(--card-text-bg); border-radius: 8px; overflow: hidden; cursor: pointer; transition: transform 0.2s; }
        .movie-card:hover { transform: scale(1.05); }
        .movie-card img { width: 100%; height: auto; aspect-ratio: 2/3; object-fit: cover; }
        .movie-info { padding: 12px; }
        .movie-info h3 { margin: 0; font-size: 14px; color: #fff; }

    </style>
</head>
<body>
    <header class="container">
        <a href="index.html"><img src="https://i.postimg.cc/yNn1wfH5/boots.jpg" alt="Logo" class="logo"></a>
    </header>
    
    <main class="container">
        <!-- Movie Poster aur Details yahan aayega -->
        <div class="movie-info-container">
            <img src="" alt="Movie Poster" id="main-poster" class="movie-poster-large">
            <div class="movie-text-details">
                <h1 id="movie-title">Loading...</h1>
                <p id="movie-description"></p>
                
                <!-- Casting Section -->
                <h2 class="section-title">Cast</h2>
                <div id="cast-list" class="cast-list"></div>

                <!-- Download Links Section -->
                <h2 class="section-title">Download Links</h2>
                <div id="download-links" class="download-links"></div>
            </div>
        </div>

        <!-- Related Movies Section -->
        <div class="related-movies">
            <h2 class="section-title">You might also like</h2>
            <div id="related-movies-grid"></div>
        </div>
    </main>

    <!-- === JAVASCRIPT LOGIC === -->
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        
        fetch('movies.json')
            .then(response => response.json())
            .then(movies => {
                const urlParams = new URLSearchParams(window.location.search);
                const movieId = urlParams.get('id');

                if (!movieId) { document.querySelector('main.container').innerHTML = `<h1>Error: Movie ID not found.</h1>`; return; }
                const currentMovie = movies.find(m => m.id == movieId);
                if (!currentMovie) { document.querySelector('main.container').innerHTML = `<h1>Error: Movie not found.</h1>`; return; }

                // 1. Movie ki basic details set karo
                document.title = `Download: ${currentMovie.title}`;
                document.getElementById('main-poster').src = currentMovie.poster;
                document.getElementById('main-poster').alt = currentMovie.title;
                document.getElementById('movie-title').textContent = currentMovie.title;
                document.getElementById('movie-description').textContent = currentMovie.details || ''; // Agar details na ho toh khaali dikhao

                // 2. Casting ki list banao
                const castContainer = document.getElementById('cast-list');
                castContainer.innerHTML = ''; // Pehle se clear karo
                if (currentMovie.cast && currentMovie.cast.length > 0) {
                    currentMovie.cast.forEach(actor => {
                        const castElement = document.createElement('span');
                        castElement.className = 'cast-member';
                        castElement.textContent = actor;
                        castContainer.appendChild(castElement);
                    });
                } else {
                    document.querySelector('.section-title').style.display = 'none'; // Agar cast nahi hai toh title chhupa do
                }

                // 3. Download buttons banao (SMART LOGIC KE SAATH)
                const downloadsContainer = document.getElementById('download-links');
                downloadsContainer.innerHTML = ''; // Pehle se clear karo
                const qualities = {
                    q480p: "480p",
                    q720p: "720p",
                    q1080p: "1080p",
                };

                for (const key in qualities) {
                    const link = currentMovie.downloadLinks ? currentMovie.downloadLinks[key] : null;
                    const button = document.createElement('a');
                    button.className = 'download-btn';
                    
                    if (link) {
                        // Agar link hai, toh download link set karo
                        button.href = link;
                        button.setAttribute('download', ''); // Taaki file download ho
                    } else {
                        // Agar link nahi hai, toh popup wala function set karo
                        button.href = 'javascript:void(0);';
                        button.onclick = () => alert('Sorry, this download link is not available yet!');
                    }
                    
                    button.innerHTML = `<svg viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg> ${qualities[key]}`;
                    downloadsContainer.appendChild(button);
                }

                // 4. Related movies dikhao
                const relatedGrid = document.getElementById('related-movies-grid');
                relatedGrid.innerHTML = '';
                const relatedMovies = movies.filter(m => m.category.includes(currentMovie.category[0]) && m.id != currentMovie.id);
                
                if (relatedMovies.length > 0) {
                    relatedMovies.slice(0, 6).forEach(movie => { // Sirf 6 related movies dikhao
                        const movieLink = document.createElement('a');
                        movieLink.href = `player.html?id=${movie.id}`;
                        movieLink.innerHTML = `<div class="movie-card"><img src="${movie.poster}" alt="${movie.title}"><div class="movie-info"><h3>${movie.title}</h3></div></div>`;
                        relatedGrid.appendChild(movieLink);
                    });
                } else {
                    document.querySelector('.related-movies').style.display = 'none';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.querySelector('main.container').innerHTML = `<h2 style="color: red;">Error: Could not load movie data.</h2>`;
            });
    });
    </script>
</body>
</html>
