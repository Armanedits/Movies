<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Movie Site</title>
    <style>
        :root { --theme-color: #e74c3c; --dark-bg: #121212; --light-bg: #1f1f1f; --text-primary: #ffffff; --text-secondary: #aaaaaa; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; background-color: var(--dark-bg); color: var(--text-primary); margin: 0; overflow-x: hidden; }
        .container { max-width: 1200px; margin: 0 auto; padding: 10px; }
        a { color: inherit; text-decoration: none; }
        header { background-color: var(--dark-bg); padding: 10px; position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid #2a2a2a; }
        .nav-bar { display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; height: 50px; }
        .nav-left, .nav-right, .logo-container { flex: 1; }
        .logo-container { text-align: center; }
        .nav-right { text-align: right; }
        header img.logo { max-width: 120px; vertical-align: middle; }
        .icon-btn { background: none; border: none; color: white; font-size: 24px; cursor: pointer; padding: 5px; transition: opacity 0.2s ease; }
        .icon-btn img { width: 28px; height: 28px; vertical-align: middle; }
        #search-container { display: none; flex-grow: 1; position: relative; }
        #searchInput { width: 100%; height: 40px; padding: 0 45px 0 15px; border-radius: 8px; border: 1px solid var(--theme-color); font-size: 16px; background-color: var(--light-bg); color: #fff; box-sizing: border-box; }
        #close-search-btn { position: absolute; right: 5px; top: 50%; transform: translateY(-50%); font-size: 28px; }
        .nav-bar.search-active .logo-container, .nav-bar.search-active .nav-left, .nav-bar.search-active .nav-right { display: none; }
        .nav-bar.search-active #search-container { display: flex; align-items: center; }
        #side-menu { position: fixed; top: 0; left: 0; height: 100%; width: 280px; background-color: #181818; z-index: 1002; transform: translateX(-100%); transition: transform 0.3s ease-in-out; padding-top: 60px; box-shadow: 5px 0 15px rgba(0,0,0,0.5); }
        #side-menu.open { transform: translateX(0); }
        #side-menu .menu-item { display: block; color: #fff; padding: 15px 25px; font-size: 18px; border-bottom: 1px solid #2a2a2a; cursor: pointer; }
        #side-menu .submenu { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-in-out; background-color: #202020; }
        #side-menu .submenu.open { max-height: 500px; }
        #side-menu .submenu .menu-item { font-size: 16px; padding-left: 40px; }
        #menu-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); z-index: 1001; display: none; }
        .slider-container { position: relative; width: 100%; margin: 20px auto; overflow: hidden; border-radius: 8px; }
        .slider-track { display: flex; }
        .slide { min-width: 100%; padding: 0 5px; box-sizing: border-box; position: relative; }
        .slide img { width: 100%; aspect-ratio: 16 / 9; object-fit: cover; border-radius: 8px; display: block; }
        .slide-title { position: absolute; bottom: 15px; left: 15px; background-color: transparent; color: #fff; padding: 8px 12px; border-radius: 5px; font-size: 18px; font-weight: bold; text-shadow: 2px 2px 5px rgba(0,0,0,0.8); }
        .slider-btn { display: none; }
        .slide-overlay-text { position: absolute; top: 10px; left: 10px; color: white; padding: 5px 10px; font-size: 12px; font-weight: bold; border-radius: 5px; z-index: 5; }
        @media (min-width: 600px) { .slide { min-width: 50%; } }
        @media (min-width: 992px) { .slide { min-width: 33.33%; } }
        .home-category-section { margin-bottom: 20px; }
        .home-category-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .home-category-header h2 { font-size: 20px; font-weight: 600; margin: 0; margin-top: 30px; }
        .show-all-btn { background-color: #2a2a2a; color: var(--text-primary); border: 1px solid #444; border-radius: 6px; padding: 8px 14px; cursor: pointer; font-size: 13px; font-weight: 500; }
        .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 12px; }
        .movie-card { cursor: pointer; transition: transform 0.2s ease; }
        .movie-card:hover { transform: scale(1.05); }
        .movie-card img { width: 100%; height: auto; display: block; border-radius: 6px; aspect-ratio: 2/3; object-fit: cover; }
        .movie-info { padding: 0 4px; }
        .movie-info h3 { font-size: 12px; font-weight: 500; margin: 8px 0 4px 0; line-height: 1.3; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .movie-info .movie-date { font-size: 11px; color: var(--text-secondary); }
        .movie-card-overlay { position: absolute; top: 5px; left: 5px; color: white; padding: 3px 6px; font-size: 10px; font-weight: bold; border-radius: 4px; z-index: 2; }
        #years-section-container { margin-top: 40px; }
        .year-section { margin-bottom: 20px; }
        .year-header { background-color: var(--light-bg); padding: 12px 15px; font-size: 18px; font-weight: 600; border-radius: 8px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border-left: 4px solid var(--theme-color); }
        .year-movie-list { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-in-out; }
        .year-movie-list.open { max-height: 2000px; padding-top: 15px; }
        .year-movie-item { display: flex; align-items: center; margin-bottom: 15px; }
        .year-movie-item img { width: 80px; height: 120px; object-fit: cover; border-radius: 6px; margin-right: 15px; }
        .year-movie-info h3 { font-size: 16px; margin: 0 0 5px 0; }
        .year-movie-info .movie-date { font-size: 14px; color: var(--text-secondary); }
    </style>
</head>
<body>
    <header><!-- ...Header HTML waisa hi hai... --></header>
    <div id="side-menu"></div> <div id="menu-overlay"></div>
    <main class="container">
        <div class="slider-container"><!-- ...Slider HTML waisa hi hai... --></div>
        <div id="home-page-content">
            <div class="home-category-section" data-section="latest"><div class="home-category-header"><h2>ðŸ”¥ Latest Releases</h2><button class="show-all-btn">Show All &#9662;</button></div><div id="latest-grid" class="movie-grid"></div></div>
            <div class="home-category-section" data-section="trending"><div class="home-category-header"><h2>ðŸ”¥ Trending</h2><button class="show-all-btn">Show All &#9662;</button></div><div id="trending-grid" class="movie-grid"></div></div>
            <div class="home-category-section" data-section="movies"><div class="home-category-header"><h2>ðŸŽ¬ Movies</h2><button class="show-all-btn">Show All &#9662;</button></div><div id="movies-grid" class="movie-grid"></div></div>
            <div class="home-category-section" data-section="webseries"><div class="home-category-header"><h2>ðŸ“º Webseries</h2><button class="show-all-btn">Show All &#9662;</button></div><div id="webseries-grid" class="movie-grid"></div></div>
        </div>
        <div id="filtered-results-container" style="display: none;"><h2 id="filtered-title"></h2><div id="filtered-grid" class="movie-grid"></div></div>
        <div id="years-section-container"></div>
    </main>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const MOVIES_JSON_URL = "movies.json";
    const YEARS_JSON_URL = "years.json";
    const ITEMS_PER_ROW = 3; // Mobile par 3 item per line
    const INITIAL_ROWS = 2;
    const INITIAL_ITEM_LIMIT = ITEMS_PER_ROW * INITIAL_ROWS;

    const categories = [ { value: 'trending', text: 'Trending' }, { value: 'webseries', text: 'Webseries' }, { value: 'bollywood', text: 'Bollywood' }, { value: 'hollywood', text: 'Hollywood' }, { value: 'tollywood', text: 'Tollywood' } ];
    let sliderInterval;
    let allMovies = [];
    
    // Sabhi elements ke references
    const homePageContent = document.getElementById('home-page-content');
    const filteredResultsContainer = document.getElementById('filtered-results-container');
    const sliderContainer = document.querySelector('.slider-container');
    const yearsContainer = document.getElementById('years-section-container');
    // ... baaki ke sabhi element references ...

    async function initializeApp() {
        try {
            const [moviesResponse, yearsResponse] = await Promise.all([ fetch(MOVIES_JSON_URL), fetch(YEARS_JSON_URL) ]);
            if (!moviesResponse.ok || !yearsResponse.ok) throw new Error('JSON files not found.');
            allMovies = await moviesResponse.json();
            const yearsData = await yearsResponse.json();
            
            populateAllHomeSections();
            populateSlider(allMovies);
            populateYearsSection(yearsData);
            setupEventListeners();
        } catch (error) { console.error('Initialization failed:', error); }
    }

    function setupEventListeners() {
        // ... sabhi event listeners (menu, search, logo) ...
    }
    
    // === YAHAN BADLAV KIYA GAYA HAI ===
    function populateAllHomeSections() {
        const sections = ['latest', 'trending', 'movies', 'webseries'];
        sections.forEach(sectionName => {
            const sectionElement = document.querySelector(`.home-category-section[data-section="${sectionName}"]`);
            if (sectionElement) {
                const moviesForSection = allMovies.filter(m => m.home_section?.includes(sectionName)).sort(createSorter(sectionName));
                const grid = sectionElement.querySelector('.movie-grid');
                const showAllBtn = sectionElement.querySelector('.show-all-btn');
                
                if (moviesForSection.length === 0) {
                    sectionElement.style.display = 'none';
                    return;
                }
                
                // Shuru mein sirf limited movies dikhana
                displayMovies(moviesForSection.slice(0, INITIAL_ITEM_LIMIT), grid);
                
                // Button ka logic
                let isShowingAll = false;
                showAllBtn.addEventListener('click', () => {
                    isShowingAll = !isShowingAll;
                    if (isShowingAll) {
                        displayMovies(moviesForSection, grid);
                        showAllBtn.innerHTML = 'Show Less &#9652;';
                    } else {
                        displayMovies(moviesForSection.slice(0, INITIAL_ITEM_LIMIT), grid);
                        showAllBtn.innerHTML = 'Show All &#9662;';
                    }
                });
            }
        });
    }
    
    const createSorter = (sectionName) => (a, b) => (a.display_orders?.[sectionName] || 999) - (b.display_orders?.[sectionName] || 999);
    
    // displayMovies, populateSlider, setupSideMenu, etc. sabhi functions waise hi hain
    // ... pichhle response ke sabhi baaki ke JavaScript functions yahan aayenge ...

    initializeApp();
});
</script>
</body>
</html>
